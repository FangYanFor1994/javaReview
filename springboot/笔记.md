### 一、构建springboot项目入门

#### 1.使用spring初始化器创建springboot项目

#####1.1步骤

![1571590153462](assets/1571590153462.png)

![1571590186989](assets/1571590186989.png)

![1571590211484](assets/1571590211484.png)

![1571590236127](assets/1571590236127.png)

![1571590271853](assets/1571590271853.png)

##### 1.2访问

```java
编写controller即可访问：（由于引入了web模块，支持springMVC）
默认端口号：8080   

@Controller
public class HelloController {
    @ResponseBody
    @RequestMapping("/hello")
    public String hello(){
        return "Hello World....";
    }
}
```

### 二、springboot核心配置

#### 1.springboot的配置文件类型(properties和yml)

```java
1.application.properties / application.yml
2.配置文件的作用：修改springboot的默认配置；
				springboot有很多默认配置，详见官网：
```

https://docs.spring.io/spring-boot/docs/2.0.6.RELEASE/reference/htmlsingle/#common-application-properties

#### 2.yml语法格式

```yaml
1.key: value 表示一对键值对（冒号后面必须有空格）
2.使用空格缩进表示层级关系，左侧缩进空格数不重要，只要同一层级元素左侧对其即可；
3.字符串默认不加引号
4.对象&Map
	一般写法：
		emp:
		  lastName: xiaomeng
		  age: 22
		  salary: 10000
	行内写法：
		emp: {lastName: xiaomeng, age: 22, salary: 10000}
		
5.数组（List & set）
	一般写法：
		fortes:
		  - java
		  - python
		  - hadoop
	行内写法：
		fortes: [java, python, hadoop]
```

**注意：properties中map和list的写法**

```properties
#对象&map
	emp.map.key1=value1
	emp.map.key2=value2
#list
	emp.list=one,two,three
```

#### 2.@ConfigurationProperties和@Value配置文件注入值的比较

**2.1@ConfigurationProperties配置文件注入值**

```java
@Component
@ConfigurationProperties(prefix = "emp")
public class Emp {
  private String lastName;
  private Integer age;
  private Double salary;
  private Boolean boss;
  private Date birthday;
  private Map map;
  private List list;
    ..getter&setter..
}
```

**2.2@Value配置文件注入值**

```java
  @Value("${emp.last-name}")
  private String lastName;
  @Value("#{10*2}")
  private Integer age;
  @Value("8000")
  private Double salary;
```

**2.3总结@Value 与 @ConfigurationProperties获取值差异**

![1571592548574](assets/1571592548574.png)

注：如果只是某个业务逻辑中需要获取配置文件某个属性值则使用@Value，如果专门使用Javabean和配置文件映射，则使用@ConfigurationProperties

#### 3.@PropertySource用于加载局部配置文件

```java
//PropertySource读取value指定的配置文件而非默认的配置文件
@PropertySource(value = {"classpath:emp.properties"})
@Component
@ConfigurationProperties(prefix = "emp")
@Validated
public class Emp {
  private String lastName;
  private Integer age;
  private Double salary;
  private Boolean boss;
  private Date birthday;
  private Map map;
  private List list;
  //特长
  private Forte forte;
```

#### 4.@ImportResource使用xml配置

```java
//将@ImportResource(locations = {"classpath:spring01.xml"})注解到配置类上，就会读取spring01.xml里面的配置
@ImportResource(locations = {"classpath:spring01.xml"})
@SpringBootApplication
public class SpringBoot02ConfigApplication {
  public static void main(String[] args) {
    SpringApplication.run(SpringBoot02ConfigApplication.class, args);
 }
}
```

#### 5.自定义配置类向容器注入组件

```java
/**
* @Configuration 用于标识当前类是一个配置类, 来表示对应的Spring配置文件
*/
@Configuration
public class EmpConfig {
  /**
  * @Bean 标识的方法用于向容器注入组件
  * 1. 方法的返回值就是注入容器中的组件对象,
  * 2. 方法名是这个组件对象的 id 值
  */
  @Bean
  public EmpService empService2() {
    System.out.println(" @Bean 注解已经将 EmpService 组件注入");
    return new EmpService();
 }
}

//总结：配置类的作用类似于application.xml，@Bean相当于<bean></bean>标示一个类注入到spring容器中，   方法名是<bean id="empService2">中id
```

#### 6.Profile多环境支持

**properties文件激活**

```
创建两个文件  application-dev.properties 与  application-prod.properties；
在主配置文件  application.properties 中指定  spring.profiles.active=dev，即可激活application-dev.properties文件；
```

**yml文件激活**

```yaml
#yaml支持多文档块方式 ---
server:
	port: 8081   # 默认端口号
spring:
    profiles:
        active: prod #激活哪个profile , 当前激活的是 dev 开发环境
---
server:
	port: 8082
spring:
	profiles: dev #指定属于哪个环境, dev 环境时使用
---
server:
	port: 8888
spring:
	profiles: prod #指定属于哪个环境, prod 环境时使用
```

#### 7.配置文件加载位置

```java
1.springboot启动时，会扫描以下位置的application.properties或application.yml作为默认配置文件：
2.高优先级的配置内容会覆盖低优先级的配置内容
```

![1571594139298](assets/1571594139298.png)

